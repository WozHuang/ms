{"version":3,"file":"jm-ms-core.js","sources":["../lib/utils.js","../lib/matcher.js","../lib/route.js","../lib/router.js","../lib/err.js","../lib/index.js"],"sourcesContent":["let preRequest = function (uri, type, data, opts) {\n  // uri为对象时直接返回\n  if (typeof uri === 'object') {\n    return uri\n  }\n\n  let r = {\n    uri: uri\n  }\n\n  // 第2个参数可能为空，data\n  if (type === undefined) {\n    return r\n  } else if (type && typeof type === 'object') {\n    return preRequest(uri, null, type, data)\n  } else if (typeof type === 'string') {\n    r.type = type\n  }\n\n  // 第3个参数可能为空，data\n  if (data === undefined) {\n    return r\n  } else if (data && typeof data === 'object') {\n    r.data = data\n  }\n\n  // 第4个参数可能为空，附加参数对象\n  if (opts === undefined) {\n    return r\n  } else if (opts && typeof opts === 'object') {\n    r = Object.assign(r, opts)\n  }\n\n  return r\n}\n\nlet utils = {\n  getUriProtocol: function (uri) {\n    if (!uri) return null\n    return uri.substring(0, uri.indexOf(':'))\n  },\n\n  getUriPath: function (uri) {\n    let idx = uri.indexOf('//')\n    if (idx === -1) return ''\n    idx = uri.indexOf('/', idx + 2)\n    if (idx === -1) return ''\n    uri = uri.substr(idx)\n    idx = uri.indexOf('#')\n    if (idx === -1) idx = uri.indexOf('?')\n    if (idx !== -1) uri = uri.substr(0, idx)\n    return uri\n  },\n\n  enableType: function (obj, types) {\n    let self = this\n    if (!Array.isArray(types)) {\n      types = [types]\n    }\n    types.forEach(function (type) {\n      obj[type] = async function () {\n        let opts = self.preRequest.apply(this, arguments)\n        opts.type = type\n        let doc = await obj.request(opts)\n        return doc\n      }\n    })\n  },\n\n  preRequest\n\n}\n\nmodule.exports =  utils\n","const pathtoRegexp = require('path-to-regexp')\n\n/**\n * Class representing a matcher.\n */\nclass Matcher {\n  /**\n   * create a matcher.\n   * @param {Object} opts\n   * @example\n   * opts:{\n   *  uri: 接口路径(必填)\n   *  type: 请求类型(可选)\n   *  sensitive: 是否大小写敏感, 默认false(可选)\n   *  strict: 是否检查末尾的分隔符, 默认false(可选)\n   *  end: When false the path will match at the beginning. (default: true)\n   * }\n   */\n  constructor (opts = {}) {\n    let uri = opts.uri || '/'\n    let type = opts.type\n    type && (type = type.toLowerCase())\n    this.type = type\n    this.keys = []\n\n    this.regexp = pathtoRegexp(uri, this.keys, opts)\n\n    if (uri === '/' && opts.end === false) {\n      this.fast_slash = true\n    }\n\n    if (type === undefined) {\n      this.allType = true\n    }\n  }\n\n  /**\n   * Check if this matcher matches `uri`, if so\n   * populate `.params and .uri`.\n   *\n   * @param {String} uri\n   * @return {Object}\n   * @api private\n   */\n  match (opts = {}) {\n    let params\n    let uri = opts.uri\n\n    let type = opts.type\n    type && (type = type.toLowerCase())\n\n    if (type !== this.type && !this.allType) return false\n    if (uri === null || uri === undefined) return false\n\n    if (this.fast_slash) {\n      // fast uri non-ending match for / (everything matches)\n      params = {}\n      uri = ''\n      return {\n        params,\n        uri\n      }\n    }\n\n    let m = this.regexp.exec(uri)\n\n    if (!m) return false\n\n    // store values\n    params = {}\n    uri = m[0]\n    let keys = this.keys\n    for (let i = 1; i < m.length; i++) {\n      let key = keys[i - 1]\n      let prop = key.name\n      params[prop] = m[i]\n    }\n\n    return {\n      params,\n      uri\n    }\n  }\n}\n\nmodule.exports = Matcher\n","const Route = require('jm-route')\nconst Matcher = require('./matcher')\n\nclass DefaultRoute extends Route {\n  /**\n   * create a route.\n   * @param {Object} opts params\n   * @example\n   * opts:{\n   *  uri: 接口路径(必填)\n   *  type: 请求类型(可选)\n   *  fn: 接口处理函数(必填)\n   *\n   * }\n   */\n  constructor (opts = {}) {\n    super(opts.fn)\n    this.name = `${opts.type || ''} ${opts.uri || ''}`\n    this.matcher = new Matcher(opts)\n    opts.router && (this.router = opts.router)\n  }\n\n  match (opts) {\n    return this.matcher.match(opts)\n  }\n}\n\nmodule.exports = DefaultRoute\n","const Route = require('./route')\nconst utils = require('./utils')\nconst error = require('jm-err')\nconst event = require('jm-event')\n\nlet Err = error.Err\nlet slice = Array.prototype.slice\n\n/**\n * Class representing a router.\n */\nclass Router {\n  /**\n   * create a router.\n   * @param {Object} opts 参数\n   * @example\n   * opts参数:{\n   *  sensitive: 是否大小写敏感(可选)\n   *  strict: 是否检查末尾的分隔符(可选)\n   *  logging 是否打印日志，默认false\n   *  benchmark 是否计算耗时，默认false\n   * }\n   */\n  constructor (opts = {}) {\n    this._routes = []\n    this.sensitive = opts.sensitive\n    this.strict = opts.strict\n    this._logging = opts.logging || false\n    this._benchmark = opts.benchmark || false\n    // alias methods\n    utils.enableType(this, ['get', 'post', 'put', 'delete'])\n    event.enableEvent(this)\n  }\n\n  get logging () {\n    return this._logging\n  }\n\n  set logging (value) {\n    this._logging = value\n    this._routes.forEach(route => {\n      route.loggint = value\n    })\n  }\n\n  get benchmark () {\n    return this._benchmark\n  }\n\n  set benchmark (value) {\n    this._benchmark = value\n    this._routes.forEach(route => {\n      route.benchmark = value\n    })\n  }\n\n  get routes () {\n    return this._routes\n  }\n\n  /**\n   * clear all routes.\n   * @return {Router} for chaining\n   */\n  clear () {\n    this._routes = []\n    return this\n  }\n\n  /**\n   * 添加接口定义\n   * @function Router#_add\n   * @param {Object} opts 参数\n   * @example\n   * opts参数:{\n   *  uri: 接口路径(必填)\n   *  type: 请求类型(可选)\n   *  fn: 接口处理函数 function(opts, cb){}, 支持数组(必填)\n   * }\n   * @return {Router} for chaining\n   */\n  _add (opts = {}) {\n    let err = null\n    let doc = null\n    if (!opts.uri || !opts.fn) {\n      doc = Err.FA_PARAMS\n      err = error.err(doc)\n      throw err\n    }\n\n    this.emit('add', opts)\n    let o = Object.assign({}, opts)\n    if (o.sensitive === undefined) o.sensitive = this.sensitive\n    if (o.strict === undefined) o.strict = this.strict\n    let route = new Route(o)\n    route.logging = this._logging\n    route.benchmark = this._benchmark\n    this._routes.push(route)\n    return this\n  }\n\n  /**\n   * 添加接口定义\n   * 支持多种参数格式, 例如\n   * add({uri:uri, type:type, fn:fn})\n   * add({uri:uri, type:type, fn:[fn1, fn2, ..., fnn]})\n   * add(uri, fn)\n   * add(uri, fn1, fn2, ..., fnn)\n   * add(uri, [fn1, fn2, ..,fnn])\n   * add(uri, type, fn)\n   * add(uri, type, fn1, fn2, ..., fnn)\n   * add(uri, type, [fn1, fn2, ..,fnn])\n   * @function Router#add\n   * @param {Object} opts 参数\n   * @example\n   * opts参数:{\n   *  uri: 接口路径(必填)\n   *  type: 请求类型(可选)\n   *  fn: 接口处理函数 function(opts, cb){}, 支持数组(必填)\n   * }\n   * @return {Router} for chaining\n   */\n  add (opts) {\n    if (typeof opts === 'string') {\n      opts = {\n        uri: opts\n      }\n      if (typeof arguments[1] === 'string') {\n        opts.type = arguments[1]\n        if (Array.isArray(arguments[2])) {\n          opts.fn = arguments[2]\n        } else {\n          opts.fn = slice.call(arguments, 2)\n        }\n      } else if (Array.isArray(arguments[1])) {\n        opts.fn = arguments[1]\n      } else {\n        opts.fn = slice.call(arguments, 1)\n      }\n    }\n    return this._add(opts)\n  }\n\n  /**\n   * 引用路由定义\n   * @function Router#_use\n   * @param {Object} opts 参数\n   * @example\n   * opts参数:{\n   *  uri: 接口路径(可选)\n   *  fn: 接口处理函数 router实例 或者 function(opts){}(支持函数数组) 或者含有request或execute函数的对象(必填)\n   * }\n   * @return {Router} for chaining\n   */\n  _use (opts = {}) {\n    let err = null\n    let doc = null\n    if (opts && typeof opts === 'object' && !opts.fn) {\n      opts = {\n        fn: opts\n      }\n    }\n    if (!opts.fn) {\n      doc = Err.FA_PARAMS\n      err = error.err(doc)\n      throw err\n    }\n\n    this.emit('use', opts)\n    opts.strict = false\n    opts.end = false\n    opts.uri || (opts.uri = '/')\n    if (typeof opts.fn === 'object') {\n      let router = opts.fn\n      if (router.request) {\n        opts.router = router\n        opts.fn = router.request.bind(router)\n      } else if (router.execute) {\n        opts.router = router\n        opts.fn = router.execute.bind(router)\n      }\n    }\n    return this._add(opts)\n  }\n\n  /**\n   * 引用路由定义\n   * use({uri:uri, fn:fn})\n   * use({uri:uri, fn:[fn1, fn2, ..., fnn]})\n   * use({uri:uri, fn:router})\n   * use({uri:uri, fn:obj}) obj必须实现了request或者execute函数之一，优先使用request\n   * use(uri, fn)\n   * use(uri, fn1, fn2, ..., fnn)\n   * use(uri, [fn1, fn2, ..,fnn])\n   * use(uri, router)\n   * use(uri, obj)\n   * use(fn)\n   * use(router)\n   * use(obj)\n   * use(fn1, fn2, ..., fnn)\n   * use([fn1, fn2, ..,fnn])\n   * @function Router#use\n   * @param {Object} opts 参数\n   * @example\n   * opts参数:{\n   *  uri: 接口路径(可选)\n   *  fn: 接口处理函数 router实例 或者 function(opts){}(必填)\n   * }\n   * @return {Router} for chaining\n   */\n  use (opts) {\n    if (typeof opts === 'string') {\n      opts = {\n        uri: opts\n      }\n      if (typeof arguments[1] === 'object') { // object 或者 数组\n        opts.fn = arguments[1]\n      } else {\n        opts.fn = slice.call(arguments, 1)\n      }\n    } else if (typeof opts === 'function') {\n      opts = {\n        fn: slice.call(arguments, 0)\n      }\n    } else if (Array.isArray(opts)) {\n      opts = {\n        fn: opts\n      }\n    } else if (typeof opts === 'object') {\n      if (!opts.fn) {\n        opts = {\n          fn: opts\n        }\n      }\n    }\n\n    return this._use(opts)\n  }\n\n  /**\n   * 请求\n   * 支持多种参数格式, 例如\n   * request({uri:uri, type:type, data:data, params:params, timeout:timeout})\n   * request(uri, type, data, opts)\n   * request(uri, type, data)\n   * request(uri, type)\n   * request(uri)\n   * @param {Object} opts 参数\n   * @example\n   * opts参数:{\n   *  uri: 接口路径(必填)\n   *  type: 请求类型(可选)\n   *  data: 请求数据(可选)\n   *  params: 请求参数(可选)\n   *  timeout: 请求超时(可选, 单位毫秒, 默认0表示不检测超时)\n   * }\n   * @return {Object}\n   */\n  async request (opts) {\n    let t1 = 0\n    if (this.logging) {\n      if (this.benchmark) t1 = Date.now()\n      let msg = `Request`\n      this.name && (msg += ` ${this.name}`)\n      msg += ` args: ${JSON.stringify(opts)}`\n      console.info(msg)\n    }\n    if (typeof opts !== 'object') {\n      opts = utils.preRequest.apply(this, arguments)\n    }\n    let doc = null\n    try {\n      doc = await this.execute(opts)\n    } catch (e) {\n      const ret = await this.emit('error', e, opts)\n      if (ret === undefined) {\n        throw e\n      }\n      doc = ret\n      if (this.logging) {\n        console.info('error catched, return', doc)\n        console.error(e)\n      }\n    }\n    if (this.logging) {\n      let msg = `Request`\n      this.name && (msg += ` ${this.name}`)\n      if (doc !== undefined) msg += ` result: ${JSON.stringify(doc)}`\n      if (this.benchmark) msg += ` Elapsed time: ${Date.now() - t1}ms`\n      console.info(msg)\n    }\n    return doc\n  }\n\n  async execute (opts) {\n    let self = this\n    let routes = self.routes\n    let parentParams = opts.params\n    let parentUri = opts.baseUri || ''\n    let done = restore(opts, opts.baseUri, opts.params)\n    opts.originalUri || (opts.originalUri = opts.uri)\n    let uri = opts.uri\n\n    for (let i = 0, len = routes.length; i < len; i++) {\n      opts.baseUri = parentUri\n      opts.uri = uri\n      let route = routes[i]\n      if (!route) {\n        continue\n      }\n      let match = route.match(opts)\n      if (!match) continue\n\n      opts.params = Object.assign({}, parentParams, match.params)\n\n      if (route.router) {\n        opts.baseUri = parentUri + match.uri\n        opts.uri = opts.uri.replace(match.uri, '')\n      }\n      let doc = await route.execute(opts)\n      done()\n      if (doc !== undefined) {\n        return doc\n      }\n    }\n\n    // restore obj props after function\n    function restore (obj, baseUri, params) {\n      return function () {\n        obj.uri = obj.originalUri\n        obj.baseUri = baseUri\n        obj.params = params\n      }\n    }\n  }\n}\n\nmodule.exports = Router\n","let ERRCODE = 900\n\nmodule.exports = {\n  FA_INVALID_TYPE: {\n    err: ERRCODE++,\n    msg: 'invalid type'\n  }\n}\n","const error = require('jm-err')\nconst event = require('jm-event')\nconst mdl = require('jm-module')\nconst utils = require('./utils')\nconst Router = require('./router')\nconst Err = require('./err')\n\n/**\n * Class representing a root.\n */\nclass Root {\n  /**\n   * create a root.\n   * @param {Object} opts 参数\n   * @example\n   * opts参数:{\n   *  logging 是否打印日志，默认false\n   *  benchmark 是否计算耗时，默认false\n   * }\n   */\n  constructor (opts = {}) {\n    mdl.enableModule(this)\n    event.enableEvent(this)\n    this.utils = utils\n    this.clientModules = {}\n    this.serverModules = {}\n    this.logging = opts.logging || false\n    this.benchmark = opts.benchmark || false\n  }\n\n  /**\n   * create a router\n   * @param {Object} opts\n   * @return {Router}\n   */\n  router (opts = {}) {\n    let self = this\n    let _opts = Object.assign({}, {logging: this.logging, benchmark: this.benchmark}, opts)\n    let app = new Router(_opts)\n\n    /**\n     * 添加代理\n     * proxy({uri:uri, target:target, changeOrigin:true})\n     * proxy(uri, target, changeOrigin)\n     * proxy(uri, target)\n     * @param {String} uri\n     * @param {String} target\n     * @param {boolean} changeOrigin 是否改变原始uri\n     */\n    app.proxy = async function (uri = {}, target, changeOrigin) {\n      let opts = uri\n      if (typeof uri === 'string') {\n        opts = {\n          uri,\n          target,\n          changeOrigin\n        }\n      }\n      if (!opts.target) {\n        let doc = error.Err.FA_PARAMS\n        let err = error.err(doc)\n        throw err\n      }\n      this.emit('proxy', opts)\n      if (typeof opts.target === 'string') {\n        opts.target = {uri: opts.target}\n      }\n      let client = await self.client(opts.target)\n\n      if (opts.changeOrigin) {\n        app.use(opts.uri, client.request.bind(client))\n      } else {\n        app.use(opts.uri, client)\n      }\n    }\n    return app\n  }\n\n  /**\n   * create a client\n   * @param {Object} opts\n   * @example\n   * opts参数:{\n   *  type: 类型(可选, 默认http)\n   *  uri: uri(可选, 默认http://127.0.0.1)\n   *  timeout: 请求超时(可选, 单位毫秒, 默认0表示不检测超时)\n   * }\n   * @return {Promise}\n   */\n  async client (opts = {}) {\n    if (typeof opts === 'string') {\n      opts = {uri: opts}\n    }\n    if (!opts.uri) throw error.err(error.Err.FA_PARAMS)\n    let err = null\n    let doc = null\n    let type = 'http'\n    opts.uri && (type = utils.getUriProtocol(opts.uri))\n    opts.type && (type = opts.type)\n    type = type.toLowerCase()\n    let fn = this.clientModules[type]\n    if (!fn) {\n      doc = Err.FA_INVALID_TYPE\n      err = error.err(doc)\n      throw err\n    }\n    doc = await fn(opts)\n    if (doc) utils.enableType(doc, ['get', 'post', 'put', 'delete'])\n    return doc\n  }\n\n  /**\n   * create a server\n   * @param {Object} app\n   * @param {Object} opts\n   * @example\n   * opts参数:{\n     *  uri: 网址(可选)\n     *  type: 类型(可选, 默认http)\n     *  host: 主机(可选, 默认127.0.0.1)\n     *  port: 端口(可选, 默认80, 根据type不同默认值也不同)\n     * }\n   * @return {Promise}\n   */\n  async server (app = null, opts = {}) {\n    let err = null\n    let doc = null\n    let type = 'http'\n    opts.uri && (type = utils.getUriProtocol(opts.uri))\n    opts.type && (type = opts.type)\n    type = type.toLowerCase()\n    let fn = this.serverModules[type]\n    if (!fn) {\n      doc = Err.FA_INVALID_TYPE\n      err = error.err(doc)\n      throw err\n    }\n    app.emit('server', opts)\n    doc = await fn(app, opts)\n    return doc\n  }\n\n  /**\n   * 创建一个代理路由\n   * 支持多种参数格式, 例如\n   * proxy({uri:uri})\n   * proxy(uri)\n   * @param {Object} opts 参数\n   * @example\n   * opts参数:{\n     *  uri: 目标uri(必填)\n     * }\n   * @return {Promise}\n   */\n  async proxy (opts = {}) {\n    let err = null\n    let doc = null\n    if (typeof opts === 'string') {\n      opts = {uri: opts}\n    }\n    if (!opts.uri) {\n      doc = error.Err.FA_PARAMS\n      err = error.err(doc)\n      throw err\n    }\n    let app = this.router()\n    let client = await this.client(opts)\n    app.use(client.request.bind(client))\n    app.client = client\n    return app\n  }\n}\n\nRoot.utils = utils\nmodule.exports = Root\n"],"names":["preRequest","uri","type","data","opts","r","undefined","Object","assign","utils","getUriProtocol","substring","indexOf","getUriPath","idx","substr","enableType","obj","types","self","Array","isArray","forEach","apply","request","Matcher","toLowerCase","keys","regexp","pathtoRegexp","end","fast_slash","allType","params","m","exec","i","length","key","prop","name","DefaultRoute","fn","matcher","router","match","Route","body","stage","shouldContinue","result","value","update","updateValue","test","state","__state","then","bind","observer","resolve","reject","Err","error","slice","prototype","Router","_routes","sensitive","strict","_logging","logging","_benchmark","benchmark","event","enableEvent","err","doc","FA_PARAMS","emit","o","route","push","arguments","call","_add","execute","_use","t1","Date","now","msg","JSON","stringify","console","info","e","ret","routes","parentParams","parentUri","baseUri","done","restore","originalUri","len","replace","loggint","ERRCODE","FA_INVALID_TYPE","_async","isNaN","Promise","Root","mdl","enableModule","clientModules","serverModules","_opts","app","proxy","target","changeOrigin","client","use"],"mappings":"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"}