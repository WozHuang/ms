{"version":3,"file":"index.js","sources":["../lib/index.js"],"sourcesContent":["function isPromise (obj) {\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function'\n}\n\n/**\n * Class representing a route.\n */\nclass Route {\n  constructor (fns) {\n    this.logging = false\n    this.benchmark = false\n    this.fns = [...arguments]\n  }\n\n  get fns () {\n    return this._fns\n  }\n\n  set fns (value) {\n    let fns = []\n    for (let i = 0, len = value.length; i < len; i++) {\n      let o = value[i]\n      if (Array.isArray(o)) {\n        fns.push(...o)\n      } else {\n        fns.push(o)\n      }\n    }\n    this._fns = fns\n  }\n\n  async execute (opts) {\n    let t1 = 0\n    let t2 = 0\n    let doc\n    let fns = this.fns\n    if (this.logging) {\n      if (this.benchmark) t1 = Date.now()\n      let msg = `Execute`\n      this.name && (msg += ` ${this.name}`)\n      msg += ` args: ${JSON.stringify([...arguments])}`\n      console.info(msg)\n    }\n    for (let i = 0, len = fns.length; i < len; i++) {\n      let fn = fns[i]\n      if (this.logging && this.benchmark) t2 = Date.now()\n      doc = fn(...arguments)\n      if (isPromise(doc)) {\n        doc = await doc\n      }\n      if (this.logging) {\n        let msg = `Step: ${i} ${fn.name} args: ${JSON.stringify([...arguments])}`\n        if (this.benchmark) msg += ` Elapsed time: ${Date.now() - t2}ms`\n        console.info(msg)\n      }\n      if (doc !== undefined) break\n    }\n    if (this.logging) {\n      let msg = `Executed`\n      this.name && (msg += ` ${this.name}`)\n      if (doc !== undefined) msg += ` result: ${JSON.stringify(doc)}`\n      if (this.benchmark) msg += ` Elapsed time: ${Date.now() - t1}ms`\n      console.info(msg)\n    }\n    if (doc !== undefined) return doc\n  }\n}\n\nmodule.exports = Route\n"],"names":["pact","value","s","v","observer","isPromise","obj","then","Route","fns","logging","benchmark","arguments","opts","t1","t2","doc","Date","now","msg","name","JSON","stringify","console","info","i","len","length","fn","undefined","_fns","o","Array","isArray","push"],"mappings":"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"}