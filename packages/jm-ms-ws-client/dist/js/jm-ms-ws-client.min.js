!function o(i,u,s){function c(n,e){if(!u[n]){if(!i[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(a)return a(n,!0);throw new Error("Cannot find module '"+n+"'")}var r=u[n]={exports:{}};i[n][0].call(r.exports,function(e){var t=i[n][1][e];return c(t||e)},r,r.exports,o,i,u,s)}return u[n].exports}for(var a="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(e("../core/fnclient")),o=i(e("./ws"));function i(e){return e&&e.__esModule?e:{default:e}}var u=(0,r.default)(o.default);n.default=u,t.exports=n.default},{"../core/fnclient":4,"./ws":3}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=o(e("./client"));function o(e){return e&&e.__esModule?e:{default:e}}var i=(0,o(e("../core/mdl")).default)(r.default);i.client=r.default,n.default=i,t.exports=n.default},{"../core/mdl":5,"./client":1}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=u(e("jm-event")),r=u(e("jm-err"));function u(e){return e&&e.__esModule?e:{default:e}}var s=r.default.Err,c=r.default.err(s.FA_NETWORK),a=function(){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var t=this;i.default.enableEvent(this);var n=new WebSocket(e);(this.ws=n).on("message",function(e){t.emit("message",e.data)}),n.onopen=function(){t.emit("open")},n.onerror=function(e){t.emit("error",e)},n.onclose=function(e){t.emit("close",e)}}return o(r,[{key:"send",value:function(){if(!this.ws)throw c;this.ws.send.apply(this.ws,arguments)}},{key:"close",value:function(){if(!this.ws)throw c;this.ws.close.apply(this.ws,arguments)}}]),r}();n.default=a,t.exports=n.default},{"jm-err":6,"jm-event":9}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var h=o(e("jm-event")),y=o(e("jm-ms-core/lib/utils")),r=o(e("jm-err"));function o(e){return e&&e.__esModule?e:{default:e}}function _(e){return function(){var s=e.apply(this,arguments);return new Promise(function(i,u){return function t(e,n){try{var r=s[e](n),o=r.value}catch(e){return void u(e)}if(!r.done)return Promise.resolve(o).then(function(e){t("next",e)},function(e){t("throw",e)});i(o)}("next")})}}var i=r.default.Err,b=r.default.err(i.FA_NETWORK);n.default=function(p){return _(regeneratorRuntime.mark(function e(){var n,i,t,r,u,o,s,c,a,f,l,d,v,m=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.Adapter||p,i=null,t=m.uri||"ws://localhost:3100",m.timeout,r=0,u={},o=y.default.getUriPath(t),s=m.prefix||"",s=o+s,!(a=!(c=null))===m.reconnect&&(a=!1),f=null,l=m.reconnectionDelay||5e3,d=m.reconnectAttempts||0,i={uri:t,prefix:s,connected:!1,autoReconnect:a,reconnectAttempts:0,reconnectionDelay:l,maxReconnectAttempts:d,onReady:function(){var n=this;return new Promise(function(e,t){if(n.connected)return e(n.connected);n.on("open",function(){e(n.connected)})})},request:function(){var t=_(regeneratorRuntime.mark(function e(t){var n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y.default.preRequest.apply(this,n),this.connected){e.next=3;break}throw b;case 3:return t.uri=this.prefix+(t.uri||""),999999<=r&&(r=0),r++,t.id=r,c.send(JSON.stringify(t)),e.abrupt("return",new Promise(function(e,t){u[r]={resolve:e,reject:t}}));case 9:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),send:function(){if(!this.connected)throw b;c.send.apply(c,arguments)},close:function(){f&&(clearTimeout(f),f=null),this.autoReconnect=!1,this.reconnectAttempts=0,this.connected&&(c.close(),c=null)}},h.default.enableEvent(i),v=function(e){i.emit("message",e);var t=null;try{t=JSON.parse(e)}catch(r){return}if(t.id&&u[t.id]){var n=u[t.id],r=null,o=t.data;o.err?(r=new Error(o.msg),n.reject(r)):n.resolve(o),delete u[t.id]}},i.connect=function(){if(!this.connected&&!c){this.autoReconnect=a,i.emit("connect");var t=i;(c=new n(this.uri)).on("message",function(e){v(e)}),c.on("open",function(){r=0,u={},t.connected=!0,t.emit("open")}),c.on("error",function(e){i.emit("error",e)}),c.on("close",function(e){if(t.connected=!1,c=null,t.emit("close",e),t.autoReconnect){if(t.maxReconnectAttempts&&t.reconnectAttempts>=t.maxReconnectAttempts)return void t.emit("connectFail");t.reconnectAttempts++,t.emit("reconnect"),f=setTimeout(function(){f=null,t.connect()},t.reconnectionDelay)}})}},i.connect(),e.abrupt("return",i);case 22:case"end":return e.stop()}},e,this)}))},t.exports=n.default},{"jm-err":6,"jm-event":9,"jm-ms-core/lib/utils":10}],5:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(n){var e=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"ms-ws-client",t=this;return t.clientModules.ws=n,{name:e,unuse:function(){delete t.clientModules.ws}}};if(void 0!==r&&r){r.jm||(r.jm={});var t=r.jm;t.ms&&t.ms.root.use(e)}return e},t.exports=n.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(l,d,v){(function(e){"use strict";Object.defineProperty(v,"__esModule",{value:!0});var t,n=l("./locale"),r=(t=n)&&t.__esModule?t:{default:t};var o={SUCCESS:{err:0,msg:"Success"},FAIL:{err:1,msg:"Fail"},FA_SYS:{err:2,msg:"System Error"},FA_NETWORK:{err:3,msg:"Network Error"},FA_PARAMS:{err:4,msg:"Parameter Error"},FA_BUSY:{err:5,msg:"Busy"},FA_TIMEOUT:{err:6,msg:"Time Out"},FA_ABORT:{err:7,msg:"Abort"},FA_NOTREADY:{err:8,msg:"Not Ready"},FA_NOTEXISTS:{err:9,msg:"Not Exists"},FA_EXISTS:{err:8,msg:"Already Exists"},OK:{err:200,msg:"OK"},FA_BADREQUEST:{err:400,msg:"Bad Request"},FA_NOAUTH:{err:401,msg:"Unauthorized"},FA_NOPERMISSION:{err:403,msg:"Forbidden"},FA_NOTFOUND:{err:404,msg:"Not Found"},FA_INTERNALERROR:{err:500,msg:"Internal Server Error"},FA_UNAVAILABLE:{err:503,msg:"Service Unavailable"}};o.t=r.default;var i=function(e,t){if(t)for(var n in t)e=e.split("${"+n+"}").join(t[n]);return e},u=function(e,t){"string"==typeof e&&(e={msg:e});var n=i(e.msg,t),r=new Error(n);return e.err&&(r.code=e.err),r},s=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"Err";return!e[t]&&(e[t]=o,e.err=u,e.errMsg=i,!0)},c={Err:o,errMsg:i,err:u,enableErr:s,disableErr:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"Err";e[t]&&(delete e[t],delete e.err,delete e.errMsg)}};if(void 0!==e&&e){e.jm||(e.jm={});var a=e.jm;if(!a.enableErr)for(var f in s(a),c)a[f]=c[f]}v.default=c,d.exports=v.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./locale":7}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){return t&&i[t]?i[t][e]:null};var r,o=e("./zh_CN");var i={zh_CN:((r=o)&&r.__esModule?r:{default:r}).default};t.exports=n.default},{"./zh_CN":8}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={Success:"成功",Fail:"失败","System Error":"系统错误","Network Error":"网络错误","Parameter Error":"参数错误",Busy:"忙","Time Out":"超时",Abort:"中止","Not Ready":"未准备好","Not Exists":"不存在","Already Exists":"已存在",OK:"OK","Bad Request":"错误请求",Unauthorized:"未验证",Forbidden:"无权限","Not Found":"未找到","Internal Server Error":"服务器内部错误","Service Unavailable":"无效服务"},t.exports=n.default},{}],9:[function(e,f,l){(function(e){"use strict";Object.defineProperty(l,"__esModule",{value:!0});var t=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._events={}}return t(e,[{key:"on",value:function(e,t,n){return this._events[e]||(this._events[e]=[]),n?this._events[e].unshift(t):this._events[e].push(t),this}},{key:"once",value:function(u,s,e){var c=this;return this.on(u,function e(t,n,r,o,i){c.off(u,e),s(t,n,r,o,i)},e)}},{key:"off",value:function(e,t){if(t){if(this._events&&this._events[e])for(var n=this._events[e],r=0;r<n.length;r++)if(t===n[r]){n.splice(r,1),n.length||delete this._events[e];break}}else void 0===e?this._events={}:this._events&&this._events[e]&&delete this._events[e];return this}},{key:"emit",value:function(e,t,n,r,o,i){for(var u=this.listeners(e),s=0;s<u.length;s++){if(!1===(0,u[s])(t,n,r,o,i))break}return this}},{key:"eventNames",value:function(){return Object.keys(this._events)}},{key:"listeners",value:function(e){var t=this._events[e];if(!t)return[];for(var n=new Array(t.length),r=0;r<t.length;r++)n[r]=t[r];return n}}]),e}(),r=n.prototype,o={_events:{},on:r.on,once:r.once,off:r.off,emit:r.emit,eventNames:r.eventNames,listeners:r.listeners},i=function(e){if(void 0!==e.emit)return!1;for(var t in o)e[t]=o[t];return e._events={},!0},u=function(e){if(void 0!==e.emit)for(var t in o)delete e[t]},s={EventEmitter:n,enableEvent:i,disableEvent:u,moduleEvent:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"event",t=this;return t.enableEvent=i,t.disableEvent=u,{name:e,unuse:function(){delete t.enableEvent,delete t.disableEvent}}}};if(void 0!==e&&e){e.jm||(e.jm={});var c=e.jm;if(!c.EventEmitter)for(var a in s)c[a]=s[a]}l.default=s,f.exports=l.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var r={getUriProtocol:function(e){return e?e.substring(0,e.indexOf(":")):null},getUriPath:function(e){var t=e.indexOf("//");return-1===t?"":-1===(t=e.indexOf("/",t+2))?"":(-1===(t=(e=e.substr(t)).indexOf("#"))&&(t=e.indexOf("?")),-1!==t&&(e=e.substr(0,t)),e)},enableType:function(i,e){var u=this;Array.isArray(e)||(e=[e]),e.forEach(function(o){var e;i[o]=(e=regeneratorRuntime.mark(function e(){var t,n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=u.preRequest.apply(this,r)).type=o,e.next=4,i.request(t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e,this)}),function(){var s=e.apply(this,arguments);return new Promise(function(i,u){return function t(e,n){try{var r=s[e](n),o=r.value}catch(e){return void u(e)}if(!r.done)return Promise.resolve(o).then(function(e){t("next",e)},function(e){t("throw",e)});i(o)}("next")})})})},preRequest:function e(t,n,r,o){if("object"===(void 0===t?"undefined":u(t)))return t;var i={uri:t};return void 0===n?i:n&&"object"===(void 0===n?"undefined":u(n))?e(t,null,n,r):("string"==typeof n&&(i.type=n),void 0===r||(r&&"object"===(void 0===r?"undefined":u(r))&&(i.data=r),void 0===o||o&&"object"===(void 0===o?"undefined":u(o))&&(i=Object.assign(i,o))),i)}};n.default=r,t.exports=n.default},{}]},{},[2]);